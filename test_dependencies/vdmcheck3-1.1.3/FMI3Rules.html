<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 2.0.17">
<title>Appendix A: Formal Static Semantics of FMI3</title>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700">
<style>
/*! Asciidoctor default stylesheet | MIT License | https://asciidoctor.org */
/* Uncomment the following line when using as a custom stylesheet */
/* @import "https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700"; */
html{font-family:sans-serif;-webkit-text-size-adjust:100%}
a{background:none}
a:focus{outline:thin dotted}
a:active,a:hover{outline:0}
h1{font-size:2em;margin:.67em 0}
b,strong{font-weight:bold}
abbr{font-size:.9em}
abbr[title]{cursor:help;border-bottom:1px dotted #dddddf;text-decoration:none}
dfn{font-style:italic}
hr{height:0}
mark{background:#ff0;color:#000}
code,kbd,pre,samp{font-family:monospace;font-size:1em}
pre{white-space:pre-wrap}
q{quotes:"\201C" "\201D" "\2018" "\2019"}
small{font-size:80%}
sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}
sup{top:-.5em}
sub{bottom:-.25em}
img{border:0}
svg:not(:root){overflow:hidden}
figure{margin:0}
audio,video{display:inline-block}
audio:not([controls]){display:none;height:0}
fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}
legend{border:0;padding:0}
button,input,select,textarea{font-family:inherit;font-size:100%;margin:0}
button,input{line-height:normal}
button,select{text-transform:none}
button,html input[type=button],input[type=reset],input[type=submit]{-webkit-appearance:button;cursor:pointer}
button[disabled],html input[disabled]{cursor:default}
input[type=checkbox],input[type=radio]{padding:0}
button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}
textarea{overflow:auto;vertical-align:top}
table{border-collapse:collapse;border-spacing:0}
*,::before,::after{box-sizing:border-box}
html,body{font-size:100%}
body{background:#fff;color:rgba(0,0,0,.8);padding:0;margin:0;font-family:"Noto Serif","DejaVu Serif",serif;line-height:1;position:relative;cursor:auto;-moz-tab-size:4;-o-tab-size:4;tab-size:4;word-wrap:anywhere;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased}
a:hover{cursor:pointer}
img,object,embed{max-width:100%;height:auto}
object,embed{height:100%}
img{-ms-interpolation-mode:bicubic}
.left{float:left!important}
.right{float:right!important}
.text-left{text-align:left!important}
.text-right{text-align:right!important}
.text-center{text-align:center!important}
.text-justify{text-align:justify!important}
.hide{display:none}
img,object,svg{display:inline-block;vertical-align:middle}
textarea{height:auto;min-height:50px}
select{width:100%}
.subheader,.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{line-height:1.45;color:#7a2518;font-weight:400;margin-top:0;margin-bottom:.25em}
div,dl,dt,dd,ul,ol,li,h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6,pre,form,p,blockquote,th,td{margin:0;padding:0}
a{color:#2156a5;text-decoration:underline;line-height:inherit}
a:hover,a:focus{color:#1d4b8f}
a img{border:0}
p{line-height:1.6;margin-bottom:1.25em;text-rendering:optimizeLegibility}
p aside{font-size:.875em;line-height:1.35;font-style:italic}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{font-family:"Open Sans","DejaVu Sans",sans-serif;font-weight:300;font-style:normal;color:#ba3925;text-rendering:optimizeLegibility;margin-top:1em;margin-bottom:.5em;line-height:1.0125em}
h1 small,h2 small,h3 small,#toctitle small,.sidebarblock>.content>.title small,h4 small,h5 small,h6 small{font-size:60%;color:#e99b8f;line-height:0}
h1{font-size:2.125em}
h2{font-size:1.6875em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.375em}
h4,h5{font-size:1.125em}
h6{font-size:1em}
hr{border:solid #dddddf;border-width:1px 0 0;clear:both;margin:1.25em 0 1.1875em}
em,i{font-style:italic;line-height:inherit}
strong,b{font-weight:bold;line-height:inherit}
small{font-size:60%;line-height:inherit}
code{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;color:rgba(0,0,0,.9)}
ul,ol,dl{line-height:1.6;margin-bottom:1.25em;list-style-position:outside;font-family:inherit}
ul,ol{margin-left:1.5em}
ul li ul,ul li ol{margin-left:1.25em;margin-bottom:0}
ul.square li ul,ul.circle li ul,ul.disc li ul{list-style:inherit}
ul.square{list-style-type:square}
ul.circle{list-style-type:circle}
ul.disc{list-style-type:disc}
ol li ul,ol li ol{margin-left:1.25em;margin-bottom:0}
dl dt{margin-bottom:.3125em;font-weight:bold}
dl dd{margin-bottom:1.25em}
blockquote{margin:0 0 1.25em;padding:.5625em 1.25em 0 1.1875em;border-left:1px solid #ddd}
blockquote,blockquote p{line-height:1.6;color:rgba(0,0,0,.85)}
@media screen and (min-width:768px){h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2}
h1{font-size:2.75em}
h2{font-size:2.3125em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.6875em}
h4{font-size:1.4375em}}
table{background:#fff;margin-bottom:1.25em;border:1px solid #dedede;word-wrap:normal}
table thead,table tfoot{background:#f7f8f7}
table thead tr th,table thead tr td,table tfoot tr th,table tfoot tr td{padding:.5em .625em .625em;font-size:inherit;color:rgba(0,0,0,.8);text-align:left}
table tr th,table tr td{padding:.5625em .625em;font-size:inherit;color:rgba(0,0,0,.8)}
table tr.even,table tr.alt{background:#f8f8f7}
table thead tr th,table tfoot tr th,table tbody tr td,table tr td,table tfoot tr td{line-height:1.6}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2;word-spacing:-.05em}
h1 strong,h2 strong,h3 strong,#toctitle strong,.sidebarblock>.content>.title strong,h4 strong,h5 strong,h6 strong{font-weight:400}
.center{margin-left:auto;margin-right:auto}
.stretch{width:100%}
.clearfix::before,.clearfix::after,.float-group::before,.float-group::after{content:" ";display:table}
.clearfix::after,.float-group::after{clear:both}
:not(pre).nobreak{word-wrap:normal}
:not(pre).nowrap{white-space:nowrap}
:not(pre).pre-wrap{white-space:pre-wrap}
:not(pre):not([class^=L])>code{font-size:.9375em;font-style:normal!important;letter-spacing:0;padding:.1em .5ex;word-spacing:-.15em;background:#f7f7f8;border-radius:4px;line-height:1.45;text-rendering:optimizeSpeed}
pre{color:rgba(0,0,0,.9);font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;line-height:1.45;text-rendering:optimizeSpeed}
pre code,pre pre{color:inherit;font-size:inherit;line-height:inherit}
pre>code{display:block}
pre.nowrap,pre.nowrap pre{white-space:pre;word-wrap:normal}
em em{font-style:normal}
strong strong{font-weight:400}
.keyseq{color:rgba(51,51,51,.8)}
kbd{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;display:inline-block;color:rgba(0,0,0,.8);font-size:.65em;line-height:1.45;background:#f7f7f7;border:1px solid #ccc;border-radius:3px;box-shadow:0 1px 0 rgba(0,0,0,.2),inset 0 0 0 .1em #fff;margin:0 .15em;padding:.2em .5em;vertical-align:middle;position:relative;top:-.1em;white-space:nowrap}
.keyseq kbd:first-child{margin-left:0}
.keyseq kbd:last-child{margin-right:0}
.menuseq,.menuref{color:#000}
.menuseq b:not(.caret),.menuref{font-weight:inherit}
.menuseq{word-spacing:-.02em}
.menuseq b.caret{font-size:1.25em;line-height:.8}
.menuseq i.caret{font-weight:bold;text-align:center;width:.45em}
b.button::before,b.button::after{position:relative;top:-1px;font-weight:400}
b.button::before{content:"[";padding:0 3px 0 2px}
b.button::after{content:"]";padding:0 2px 0 3px}
p a>code:hover{color:rgba(0,0,0,.9)}
#header,#content,#footnotes,#footer{width:100%;margin:0 auto;max-width:62.5em;*zoom:1;position:relative;padding-left:.9375em;padding-right:.9375em}
#header::before,#header::after,#content::before,#content::after,#footnotes::before,#footnotes::after,#footer::before,#footer::after{content:" ";display:table}
#header::after,#content::after,#footnotes::after,#footer::after{clear:both}
#content{margin-top:1.25em}
#content::before{content:none}
#header>h1:first-child{color:rgba(0,0,0,.85);margin-top:2.25rem;margin-bottom:0}
#header>h1:first-child+#toc{margin-top:8px;border-top:1px solid #dddddf}
#header>h1:only-child,body.toc2 #header>h1:nth-last-child(2){border-bottom:1px solid #dddddf;padding-bottom:8px}
#header .details{border-bottom:1px solid #dddddf;line-height:1.45;padding-top:.25em;padding-bottom:.25em;padding-left:.25em;color:rgba(0,0,0,.6);display:flex;flex-flow:row wrap}
#header .details span:first-child{margin-left:-.125em}
#header .details span.email a{color:rgba(0,0,0,.85)}
#header .details br{display:none}
#header .details br+span::before{content:"\00a0\2013\00a0"}
#header .details br+span.author::before{content:"\00a0\22c5\00a0";color:rgba(0,0,0,.85)}
#header .details br+span#revremark::before{content:"\00a0|\00a0"}
#header #revnumber{text-transform:capitalize}
#header #revnumber::after{content:"\00a0"}
#content>h1:first-child:not([class]){color:rgba(0,0,0,.85);border-bottom:1px solid #dddddf;padding-bottom:8px;margin-top:0;padding-top:1rem;margin-bottom:1.25rem}
#toc{border-bottom:1px solid #e7e7e9;padding-bottom:.5em}
#toc>ul{margin-left:.125em}
#toc ul.sectlevel0>li>a{font-style:italic}
#toc ul.sectlevel0 ul.sectlevel1{margin:.5em 0}
#toc ul{font-family:"Open Sans","DejaVu Sans",sans-serif;list-style-type:none}
#toc li{line-height:1.3334;margin-top:.3334em}
#toc a{text-decoration:none}
#toc a:active{text-decoration:underline}
#toctitle{color:#7a2518;font-size:1.2em}
@media screen and (min-width:768px){#toctitle{font-size:1.375em}
body.toc2{padding-left:15em;padding-right:0}
#toc.toc2{margin-top:0!important;background:#f8f8f7;position:fixed;width:15em;left:0;top:0;border-right:1px solid #e7e7e9;border-top-width:0!important;border-bottom-width:0!important;z-index:1000;padding:1.25em 1em;height:100%;overflow:auto}
#toc.toc2 #toctitle{margin-top:0;margin-bottom:.8rem;font-size:1.2em}
#toc.toc2>ul{font-size:.9em;margin-bottom:0}
#toc.toc2 ul ul{margin-left:0;padding-left:1em}
#toc.toc2 ul.sectlevel0 ul.sectlevel1{padding-left:0;margin-top:.5em;margin-bottom:.5em}
body.toc2.toc-right{padding-left:0;padding-right:15em}
body.toc2.toc-right #toc.toc2{border-right-width:0;border-left:1px solid #e7e7e9;left:auto;right:0}}
@media screen and (min-width:1280px){body.toc2{padding-left:20em;padding-right:0}
#toc.toc2{width:20em}
#toc.toc2 #toctitle{font-size:1.375em}
#toc.toc2>ul{font-size:.95em}
#toc.toc2 ul ul{padding-left:1.25em}
body.toc2.toc-right{padding-left:0;padding-right:20em}}
#content #toc{border:1px solid #e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;border-radius:4px}
#content #toc>:first-child{margin-top:0}
#content #toc>:last-child{margin-bottom:0}
#footer{max-width:none;background:rgba(0,0,0,.8);padding:1.25em}
#footer-text{color:hsla(0,0%,100%,.8);line-height:1.44}
#content{margin-bottom:.625em}
.sect1{padding-bottom:.625em}
@media screen and (min-width:768px){#content{margin-bottom:1.25em}
.sect1{padding-bottom:1.25em}}
.sect1:last-child{padding-bottom:0}
.sect1+.sect1{border-top:1px solid #e7e7e9}
#content h1>a.anchor,h2>a.anchor,h3>a.anchor,#toctitle>a.anchor,.sidebarblock>.content>.title>a.anchor,h4>a.anchor,h5>a.anchor,h6>a.anchor{position:absolute;z-index:1001;width:1.5ex;margin-left:-1.5ex;display:block;text-decoration:none!important;visibility:hidden;text-align:center;font-weight:400}
#content h1>a.anchor::before,h2>a.anchor::before,h3>a.anchor::before,#toctitle>a.anchor::before,.sidebarblock>.content>.title>a.anchor::before,h4>a.anchor::before,h5>a.anchor::before,h6>a.anchor::before{content:"\00A7";font-size:.85em;display:block;padding-top:.1em}
#content h1:hover>a.anchor,#content h1>a.anchor:hover,h2:hover>a.anchor,h2>a.anchor:hover,h3:hover>a.anchor,#toctitle:hover>a.anchor,.sidebarblock>.content>.title:hover>a.anchor,h3>a.anchor:hover,#toctitle>a.anchor:hover,.sidebarblock>.content>.title>a.anchor:hover,h4:hover>a.anchor,h4>a.anchor:hover,h5:hover>a.anchor,h5>a.anchor:hover,h6:hover>a.anchor,h6>a.anchor:hover{visibility:visible}
#content h1>a.link,h2>a.link,h3>a.link,#toctitle>a.link,.sidebarblock>.content>.title>a.link,h4>a.link,h5>a.link,h6>a.link{color:#ba3925;text-decoration:none}
#content h1>a.link:hover,h2>a.link:hover,h3>a.link:hover,#toctitle>a.link:hover,.sidebarblock>.content>.title>a.link:hover,h4>a.link:hover,h5>a.link:hover,h6>a.link:hover{color:#a53221}
details,.audioblock,.imageblock,.literalblock,.listingblock,.stemblock,.videoblock{margin-bottom:1.25em}
details{margin-left:1.25rem}
details>summary{cursor:pointer;display:block;position:relative;line-height:1.6;margin-bottom:.625rem;outline:none;-webkit-tap-highlight-color:transparent}
details>summary::-webkit-details-marker{display:none}
details>summary::before{content:"";border:solid transparent;border-left:solid;border-width:.3em 0 .3em .5em;position:absolute;top:.5em;left:-1.25rem;transform:translateX(15%)}
details[open]>summary::before{border:solid transparent;border-top:solid;border-width:.5em .3em 0;transform:translateY(15%)}
details>summary::after{content:"";width:1.25rem;height:1em;position:absolute;top:.3em;left:-1.25rem}
.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{text-rendering:optimizeLegibility;text-align:left;font-family:"Noto Serif","DejaVu Serif",serif;font-size:1rem;font-style:italic}
table.tableblock.fit-content>caption.title{white-space:nowrap;width:0}
.paragraph.lead>p,#preamble>.sectionbody>[class=paragraph]:first-of-type p{font-size:1.21875em;line-height:1.6;color:rgba(0,0,0,.85)}
.admonitionblock>table{border-collapse:separate;border:0;background:none;width:100%}
.admonitionblock>table td.icon{text-align:center;width:80px}
.admonitionblock>table td.icon img{max-width:none}
.admonitionblock>table td.icon .title{font-weight:bold;font-family:"Open Sans","DejaVu Sans",sans-serif;text-transform:uppercase}
.admonitionblock>table td.content{padding-left:1.125em;padding-right:1.25em;border-left:1px solid #dddddf;color:rgba(0,0,0,.6);word-wrap:anywhere}
.admonitionblock>table td.content>:last-child>:last-child{margin-bottom:0}
.exampleblock>.content{border:1px solid #e6e6e6;margin-bottom:1.25em;padding:1.25em;background:#fff;border-radius:4px}
.exampleblock>.content>:first-child{margin-top:0}
.exampleblock>.content>:last-child{margin-bottom:0}
.sidebarblock{border:1px solid #dbdbd6;margin-bottom:1.25em;padding:1.25em;background:#f3f3f2;border-radius:4px}
.sidebarblock>:first-child{margin-top:0}
.sidebarblock>:last-child{margin-bottom:0}
.sidebarblock>.content>.title{color:#7a2518;margin-top:0;text-align:center}
.exampleblock>.content>:last-child>:last-child,.exampleblock>.content .olist>ol>li:last-child>:last-child,.exampleblock>.content .ulist>ul>li:last-child>:last-child,.exampleblock>.content .qlist>ol>li:last-child>:last-child,.sidebarblock>.content>:last-child>:last-child,.sidebarblock>.content .olist>ol>li:last-child>:last-child,.sidebarblock>.content .ulist>ul>li:last-child>:last-child,.sidebarblock>.content .qlist>ol>li:last-child>:last-child{margin-bottom:0}
.literalblock pre,.listingblock>.content>pre{border-radius:4px;overflow-x:auto;padding:1em;font-size:.8125em}
@media screen and (min-width:768px){.literalblock pre,.listingblock>.content>pre{font-size:.90625em}}
@media screen and (min-width:1280px){.literalblock pre,.listingblock>.content>pre{font-size:1em}}
.literalblock pre,.listingblock>.content>pre:not(.highlight),.listingblock>.content>pre[class=highlight],.listingblock>.content>pre[class^="highlight "]{background:#f7f7f8}
.literalblock.output pre{color:#f7f7f8;background:rgba(0,0,0,.9)}
.listingblock>.content{position:relative}
.listingblock code[data-lang]::before{display:none;content:attr(data-lang);position:absolute;font-size:.75em;top:.425rem;right:.5rem;line-height:1;text-transform:uppercase;color:inherit;opacity:.5}
.listingblock:hover code[data-lang]::before{display:block}
.listingblock.terminal pre .command::before{content:attr(data-prompt);padding-right:.5em;color:inherit;opacity:.5}
.listingblock.terminal pre .command:not([data-prompt])::before{content:"$"}
.listingblock pre.highlightjs{padding:0}
.listingblock pre.highlightjs>code{padding:1em;border-radius:4px}
.listingblock pre.prettyprint{border-width:0}
.prettyprint{background:#f7f7f8}
pre.prettyprint .linenums{line-height:1.45;margin-left:2em}
pre.prettyprint li{background:none;list-style-type:inherit;padding-left:0}
pre.prettyprint li code[data-lang]::before{opacity:1}
pre.prettyprint li:not(:first-child) code[data-lang]::before{display:none}
table.linenotable{border-collapse:separate;border:0;margin-bottom:0;background:none}
table.linenotable td[class]{color:inherit;vertical-align:top;padding:0;line-height:inherit;white-space:normal}
table.linenotable td.code{padding-left:.75em}
table.linenotable td.linenos,pre.pygments .linenos{border-right:1px solid;opacity:.35;padding-right:.5em;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}
pre.pygments span.linenos{display:inline-block;margin-right:.75em}
.quoteblock{margin:0 1em 1.25em 1.5em;display:table}
.quoteblock:not(.excerpt)>.title{margin-left:-1.5em;margin-bottom:.75em}
.quoteblock blockquote,.quoteblock p{color:rgba(0,0,0,.85);font-size:1.15rem;line-height:1.75;word-spacing:.1em;letter-spacing:0;font-style:italic;text-align:justify}
.quoteblock blockquote{margin:0;padding:0;border:0}
.quoteblock blockquote::before{content:"\201c";float:left;font-size:2.75em;font-weight:bold;line-height:.6em;margin-left:-.6em;color:#7a2518;text-shadow:0 1px 2px rgba(0,0,0,.1)}
.quoteblock blockquote>.paragraph:last-child p{margin-bottom:0}
.quoteblock .attribution{margin-top:.75em;margin-right:.5ex;text-align:right}
.verseblock{margin:0 1em 1.25em}
.verseblock pre{font-family:"Open Sans","DejaVu Sans",sans-serif;font-size:1.15rem;color:rgba(0,0,0,.85);font-weight:300;text-rendering:optimizeLegibility}
.verseblock pre strong{font-weight:400}
.verseblock .attribution{margin-top:1.25rem;margin-left:.5ex}
.quoteblock .attribution,.verseblock .attribution{font-size:.9375em;line-height:1.45;font-style:italic}
.quoteblock .attribution br,.verseblock .attribution br{display:none}
.quoteblock .attribution cite,.verseblock .attribution cite{display:block;letter-spacing:-.025em;color:rgba(0,0,0,.6)}
.quoteblock.abstract blockquote::before,.quoteblock.excerpt blockquote::before,.quoteblock .quoteblock blockquote::before{display:none}
.quoteblock.abstract blockquote,.quoteblock.abstract p,.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{line-height:1.6;word-spacing:0}
.quoteblock.abstract{margin:0 1em 1.25em;display:block}
.quoteblock.abstract>.title{margin:0 0 .375em;font-size:1.15em;text-align:center}
.quoteblock.excerpt>blockquote,.quoteblock .quoteblock{padding:0 0 .25em 1em;border-left:.25em solid #dddddf}
.quoteblock.excerpt,.quoteblock .quoteblock{margin-left:0}
.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{color:inherit;font-size:1.0625rem}
.quoteblock.excerpt .attribution,.quoteblock .quoteblock .attribution{color:inherit;font-size:.85rem;text-align:left;margin-right:0}
p.tableblock:last-child{margin-bottom:0}
td.tableblock>.content{margin-bottom:1.25em;word-wrap:anywhere}
td.tableblock>.content>:last-child{margin-bottom:-1.25em}
table.tableblock,th.tableblock,td.tableblock{border:0 solid #dedede}
table.grid-all>*>tr>*{border-width:1px}
table.grid-cols>*>tr>*{border-width:0 1px}
table.grid-rows>*>tr>*{border-width:1px 0}
table.frame-all{border-width:1px}
table.frame-ends{border-width:1px 0}
table.frame-sides{border-width:0 1px}
table.frame-none>colgroup+*>:first-child>*,table.frame-sides>colgroup+*>:first-child>*{border-top-width:0}
table.frame-none>:last-child>:last-child>*,table.frame-sides>:last-child>:last-child>*{border-bottom-width:0}
table.frame-none>*>tr>:first-child,table.frame-ends>*>tr>:first-child{border-left-width:0}
table.frame-none>*>tr>:last-child,table.frame-ends>*>tr>:last-child{border-right-width:0}
table.stripes-all>*>tr,table.stripes-odd>*>tr:nth-of-type(odd),table.stripes-even>*>tr:nth-of-type(even),table.stripes-hover>*>tr:hover{background:#f8f8f7}
th.halign-left,td.halign-left{text-align:left}
th.halign-right,td.halign-right{text-align:right}
th.halign-center,td.halign-center{text-align:center}
th.valign-top,td.valign-top{vertical-align:top}
th.valign-bottom,td.valign-bottom{vertical-align:bottom}
th.valign-middle,td.valign-middle{vertical-align:middle}
table thead th,table tfoot th{font-weight:bold}
tbody tr th{background:#f7f8f7}
tbody tr th,tbody tr th p,tfoot tr th,tfoot tr th p{color:rgba(0,0,0,.8);font-weight:bold}
p.tableblock>code:only-child{background:none;padding:0}
p.tableblock{font-size:1em}
ol{margin-left:1.75em}
ul li ol{margin-left:1.5em}
dl dd{margin-left:1.125em}
dl dd:last-child,dl dd:last-child>:last-child{margin-bottom:0}
li p,ul dd,ol dd,.olist .olist,.ulist .ulist,.ulist .olist,.olist .ulist{margin-bottom:.625em}
ul.checklist,ul.none,ol.none,ul.no-bullet,ol.no-bullet,ol.unnumbered,ul.unstyled,ol.unstyled{list-style-type:none}
ul.no-bullet,ol.no-bullet,ol.unnumbered{margin-left:.625em}
ul.unstyled,ol.unstyled{margin-left:0}
li>p:empty:only-child::before{content:"";display:inline-block}
ul.checklist>li>p:first-child{margin-left:-1em}
ul.checklist>li>p:first-child>.fa-square-o:first-child,ul.checklist>li>p:first-child>.fa-check-square-o:first-child{width:1.25em;font-size:.8em;position:relative;bottom:.125em}
ul.checklist>li>p:first-child>input[type=checkbox]:first-child{margin-right:.25em}
ul.inline{display:flex;flex-flow:row wrap;list-style:none;margin:0 0 .625em -1.25em}
ul.inline>li{margin-left:1.25em}
.unstyled dl dt{font-weight:400;font-style:normal}
ol.arabic{list-style-type:decimal}
ol.decimal{list-style-type:decimal-leading-zero}
ol.loweralpha{list-style-type:lower-alpha}
ol.upperalpha{list-style-type:upper-alpha}
ol.lowerroman{list-style-type:lower-roman}
ol.upperroman{list-style-type:upper-roman}
ol.lowergreek{list-style-type:lower-greek}
.hdlist>table,.colist>table{border:0;background:none}
.hdlist>table>tbody>tr,.colist>table>tbody>tr{background:none}
td.hdlist1,td.hdlist2{vertical-align:top;padding:0 .625em}
td.hdlist1{font-weight:bold;padding-bottom:1.25em}
td.hdlist2{word-wrap:anywhere}
.literalblock+.colist,.listingblock+.colist{margin-top:-.5em}
.colist td:not([class]):first-child{padding:.4em .75em 0;line-height:1;vertical-align:top}
.colist td:not([class]):first-child img{max-width:none}
.colist td:not([class]):last-child{padding:.25em 0}
.thumb,.th{line-height:0;display:inline-block;border:4px solid #fff;box-shadow:0 0 0 1px #ddd}
.imageblock.left{margin:.25em .625em 1.25em 0}
.imageblock.right{margin:.25em 0 1.25em .625em}
.imageblock>.title{margin-bottom:0}
.imageblock.thumb,.imageblock.th{border-width:6px}
.imageblock.thumb>.title,.imageblock.th>.title{padding:0 .125em}
.image.left,.image.right{margin-top:.25em;margin-bottom:.25em;display:inline-block;line-height:0}
.image.left{margin-right:.625em}
.image.right{margin-left:.625em}
a.image{text-decoration:none;display:inline-block}
a.image object{pointer-events:none}
sup.footnote,sup.footnoteref{font-size:.875em;position:static;vertical-align:super}
sup.footnote a,sup.footnoteref a{text-decoration:none}
sup.footnote a:active,sup.footnoteref a:active{text-decoration:underline}
#footnotes{padding-top:.75em;padding-bottom:.75em;margin-bottom:.625em}
#footnotes hr{width:20%;min-width:6.25em;margin:-.25em 0 .75em;border-width:1px 0 0}
#footnotes .footnote{padding:0 .375em 0 .225em;line-height:1.3334;font-size:.875em;margin-left:1.2em;margin-bottom:.2em}
#footnotes .footnote a:first-of-type{font-weight:bold;text-decoration:none;margin-left:-1.05em}
#footnotes .footnote:last-of-type{margin-bottom:0}
#content #footnotes{margin-top:-.625em;margin-bottom:0;padding:.75em 0}
div.unbreakable{page-break-inside:avoid}
.big{font-size:larger}
.small{font-size:smaller}
.underline{text-decoration:underline}
.overline{text-decoration:overline}
.line-through{text-decoration:line-through}
.aqua{color:#00bfbf}
.aqua-background{background:#00fafa}
.black{color:#000}
.black-background{background:#000}
.blue{color:#0000bf}
.blue-background{background:#0000fa}
.fuchsia{color:#bf00bf}
.fuchsia-background{background:#fa00fa}
.gray{color:#606060}
.gray-background{background:#7d7d7d}
.green{color:#006000}
.green-background{background:#007d00}
.lime{color:#00bf00}
.lime-background{background:#00fa00}
.maroon{color:#600000}
.maroon-background{background:#7d0000}
.navy{color:#000060}
.navy-background{background:#00007d}
.olive{color:#606000}
.olive-background{background:#7d7d00}
.purple{color:#600060}
.purple-background{background:#7d007d}
.red{color:#bf0000}
.red-background{background:#fa0000}
.silver{color:#909090}
.silver-background{background:#bcbcbc}
.teal{color:#006060}
.teal-background{background:#007d7d}
.white{color:#bfbfbf}
.white-background{background:#fafafa}
.yellow{color:#bfbf00}
.yellow-background{background:#fafa00}
span.icon>.fa{cursor:default}
a span.icon>.fa{cursor:inherit}
.admonitionblock td.icon [class^="fa icon-"]{font-size:2.5em;text-shadow:1px 1px 2px rgba(0,0,0,.5);cursor:default}
.admonitionblock td.icon .icon-note::before{content:"\f05a";color:#19407c}
.admonitionblock td.icon .icon-tip::before{content:"\f0eb";text-shadow:1px 1px 2px rgba(155,155,0,.8);color:#111}
.admonitionblock td.icon .icon-warning::before{content:"\f071";color:#bf6900}
.admonitionblock td.icon .icon-caution::before{content:"\f06d";color:#bf3400}
.admonitionblock td.icon .icon-important::before{content:"\f06a";color:#bf0000}
.conum[data-value]{display:inline-block;color:#fff!important;background:rgba(0,0,0,.8);border-radius:50%;text-align:center;font-size:.75em;width:1.67em;height:1.67em;line-height:1.67em;font-family:"Open Sans","DejaVu Sans",sans-serif;font-style:normal;font-weight:bold}
.conum[data-value] *{color:#fff!important}
.conum[data-value]+b{display:none}
.conum[data-value]::after{content:attr(data-value)}
pre .conum[data-value]{position:relative;top:-.125em}
b.conum *{color:inherit!important}
.conum:not([data-value]):empty{display:none}
dt,th.tableblock,td.content,div.footnote{text-rendering:optimizeLegibility}
h1,h2,p,td.content,span.alt,summary{letter-spacing:-.01em}
p strong,td.content strong,div.footnote strong{letter-spacing:-.005em}
p,blockquote,dt,td.content,span.alt,summary{font-size:1.0625rem}
p{margin-bottom:1.25rem}
.sidebarblock p,.sidebarblock dt,.sidebarblock td.content,p.tableblock{font-size:1em}
.exampleblock>.content{background:#fffef7;border-color:#e0e0dc;box-shadow:0 1px 4px #e0e0dc}
.print-only{display:none!important}
@page{margin:1.25cm .75cm}
@media print{*{box-shadow:none!important;text-shadow:none!important}
html{font-size:80%}
a{color:inherit!important;text-decoration:underline!important}
a.bare,a[href^="#"],a[href^="mailto:"]{text-decoration:none!important}
a[href^="http:"]:not(.bare)::after,a[href^="https:"]:not(.bare)::after{content:"(" attr(href) ")";display:inline-block;font-size:.875em;padding-left:.25em}
abbr[title]{border-bottom:1px dotted}
abbr[title]::after{content:" (" attr(title) ")"}
pre,blockquote,tr,img,object,svg{page-break-inside:avoid}
thead{display:table-header-group}
svg{max-width:100%}
p,blockquote,dt,td.content{font-size:1em;orphans:3;widows:3}
h2,h3,#toctitle,.sidebarblock>.content>.title{page-break-after:avoid}
#header,#content,#footnotes,#footer{max-width:none}
#toc,.sidebarblock,.exampleblock>.content{background:none!important}
#toc{border-bottom:1px solid #dddddf!important;padding-bottom:0!important}
body.book #header{text-align:center}
body.book #header>h1:first-child{border:0!important;margin:2.5em 0 1em}
body.book #header .details{border:0!important;display:block;padding:0!important}
body.book #header .details span:first-child{margin-left:0!important}
body.book #header .details br{display:block}
body.book #header .details br+span::before{content:none!important}
body.book #toc{border:0!important;text-align:left!important;padding:0!important;margin:0!important}
body.book #toc,body.book #preamble,body.book h1.sect0,body.book .sect1>h2{page-break-before:always}
.listingblock code[data-lang]::before{display:block}
#footer{padding:0 .9375em}
.hide-on-print{display:none!important}
.print-only{display:block!important}
.hide-for-print{display:none!important}
.show-for-print{display:inherit!important}}
@media amzn-kf8,print{#header>h1:first-child{margin-top:1.25rem}
.sect1{padding:0!important}
.sect1+.sect1{border:0}
#footer{background:none}
#footer-text{color:rgba(0,0,0,.6);font-size:.9em}}
@media amzn-kf8{#header,#content,#footnotes,#footer{padding:0}}
</style>
</head>
<body class="article">
<div id="header">
</div>
<div id="content">
<div class="sect1">
<h2 id="_appendix_a_formal_static_semantics_of_fmi3">Appendix A: Formal Static Semantics of FMI3</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_a_1_introduction">A.1 Introduction</h3>
<div class="paragraph">
<p>The FMI Standard document contains a complete description of the semantics of the FMI API, and the structure of an FMU and its configuration files.</p>
</div>
<div class="paragraph">
<p>This document contains formally specified rules that clarify the textual description in the Standard. The formal rules can be used to automatically test the compliance of an FMU with the Standard, and rule violations give references back to the Standard where the issue is discussed. Similarly, links in the Standard refer to the rules given in this document.</p>
</div>
<div class="paragraph">
<p>The rules currently only cover the <em>static</em> semantics of the Standard. That is, they describe the rules for correctly configured XML files. The dynamic semantics, defining the behaviour of the API, may be formally specified subsequently.</p>
</div>
</div>
<div class="sect2">
<h3 id="_a_2_vdm_sl_specifications">A.2 VDM-SL Specifications</h3>
<div class="paragraph">
<p>The rules are defined in VDM-SL, the specification language of the <a href="https://en.wikipedia.org/wiki/Vienna_Development_Method">Vienna Development Method</a>.  The language has a formal semantics, enabling proof of the properties of models to a high level of assurance. It also has an executable subset, so that real world data can be processed.</p>
</div>
<div class="paragraph">
<p>Free <a href="https://github.com/overturetool/vdm-vscode">open source tools</a> are available to process the VDM-SL rules.</p>
</div>
</div>
<div class="sect2">
<h3 id="_a_3_structure_of_the_rules">A.3 Structure of the Rules</h3>
<div class="paragraph">
<p>Each formal rule has a unique name and is associated with one XML type in the FMI Schema.</p>
</div>
<div class="paragraph">
<p>Rules are associated with the most nested XML type that encapsulates all of the data involved. For example, the rule that Category names must be unique within LogCategories is associated with the LogCategories type itself, since that includes all the Categories concerned. The rule that a TypeDefinition&#8217;s unit names must be defined in the UnitDefinitions is associated with the top level FmiModelDescription type, since that type encompasses both the TypeDefinitions and UnitDefinitions.</p>
</div>
<div class="paragraph">
<p>All rules are functions that return a boolean success/fail result. They are passed the record that contains the data to check. For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>validTolerance: DefaultExperiment +&gt; bool
validTolerance(de) ==
	-- @OnFail("%NAME: tolerance must be &gt;= 0 at %#s", loc2str(de.location))
	( de.tolerance &lt;&gt; nil =&gt; de.tolerance &gt;= 0 );</pre>
</div>
</div>
<div class="paragraph">
<p>This defines a rule called "validTolerance" which is passed a DefaultExperiment record to test. The record is referred to by the name "de" within the body of the rule, which follows the "==".</p>
</div>
<div class="paragraph">
<p>Rules contain <em>@OnFail</em> comments, which define error messages associated with clauses in the rule. The comments themselves are not part of the rules and do not affect whether the rule succeeds or fails. The <em>%NAME</em> placeholder is expanded to the rule name. All XML types have a <em>location</em> field added which contains the filename and line number of the data in the original XML. The <em>loc2str</em> function turns locations into useful strings.</p>
</div>
<div class="paragraph">
<p>Rules sometimes use a function called <em>allOf</em>, which is passed a comma-separated list of boolean tests in square brackets, all of which must be true for the overall rule to be met.</p>
</div>
</div>
<div class="sect2">
<h3 id="_a_4_rules">A.4 Rules</h3>
<div class="sect3">
<h4 id="_a_4_1_modelexchange_rules">A.4.1 ModelExchange Rules</h4>
<div class="sect4">
<h5 id="_a_4_1_1_rule_validmemodelidentifier">A.4.1.1 Rule: validMEModelIdentifier</h5>
<div id="validMEModelIdentifier" class="listingblock">
<div class="content">
<pre>validMEModelIdentifier: ModelExchange +&gt; bool
validMEModelIdentifier(me) ==
	-- @OnFail("%NAME: %s not valid C variable name at %#s", me.modelIdentifier, loc2str(me.location))
	( validIdentifier(me.modelIdentifier) );</pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>See <a href="#modelIdentifier">[modelIdentifier]</a>.</p>
</li>
<li>
<p>See <a href="#header-files-and-naming-of-functions">[header-files-and-naming-of-functions]</a>.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_a_4_2_cosimulation_rules">A.4.2 CoSimulation Rules</h4>
<div class="sect4">
<h5 id="_a_4_2_1_rule_validcsmodelidentifier">A.4.2.1 Rule: validCSModelIdentifier</h5>
<div id="validCSModelIdentifier" class="listingblock">
<div class="content">
<pre>validCSModelIdentifier: CoSimulation +&gt; bool
validCSModelIdentifier(ecs) ==
	-- @OnFail("%NAME: %s not valid C variable name at %#s",
	-- ecs.modelIdentifier, loc2str(ecs.location))
	( validIdentifier(ecs.modelIdentifier) );</pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>See <a href="#modelIdentifier">[modelIdentifier]</a>.</p>
</li>
<li>
<p>See <a href="#header-files-and-naming-of-functions">[header-files-and-naming-of-functions]</a>.</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="_a_4_2_2_rule_validcsintermediateupdate">A.4.2.2 Rule: validCSIntermediateUpdate</h5>
<div id="validCSIntermediateUpdate" class="listingblock">
<div class="content">
<pre>validCSIntermediateUpdate: CoSimulation +&gt; bool
validCSIntermediateUpdate(ecs) ==
	-- @OnFail("%NAME: canReturnEarlyAfterIntermediateUpdate requires providesIntermediateUpdate")
	( ecs.canReturnEarlyAfterIntermediateUpdate = true =&gt; ecs.providesIntermediateUpdate );</pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>See <a href="#table-CoSimulation-details">[table-CoSimulation-details]</a>.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_a_4_3_scheduledexecution_rules">A.4.3 ScheduledExecution Rules</h4>
<div class="sect4">
<h5 id="_a_4_3_1_rule_validsemodelidentifier">A.4.3.1 Rule: validSEModelIdentifier</h5>
<div id="validSEModelIdentifier" class="listingblock">
<div class="content">
<pre>validSEModelIdentifier: ScheduledExecution +&gt; bool
validSEModelIdentifier(se) ==
	-- @OnFail("%NAME: %s not a valid C variable name at %#s",
	-- se.modelIdentifier, loc2str(se.location))
	( validIdentifier(se.modelIdentifier) );</pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>See <a href="#modelIdentifier">[modelIdentifier]</a>.</p>
</li>
<li>
<p>See <a href="#header-files-and-naming-of-functions">[header-files-and-naming-of-functions]</a>.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_a_4_4_unitdefinition_rules">A.4.4 UnitDefinition Rules</h4>
<div class="sect4">
<h5 id="_a_4_4_1_rule_validunitnames">A.4.4.1 Rule: validUnitNames</h5>
<div id="validUnitNames" class="listingblock">
<div class="content">
<pre>validUnitNames: UnitDefinitions +&gt; bool
validUnitNames(units) ==
	-- @OnFail("%NAME: Unit names must be unique")
	( let names = [ u.name | u in seq units ] in
		len names = card elems names );</pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>See <a href="#_physical_units">[_physical_units]</a>.</p>
</li>
<li>
<p>See <a href="#uniqueNameAttribute">[uniqueNameAttribute]</a>.</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="_a_4_4_2_rule_validdisplayunitnames">A.4.4.2 Rule: validDisplayUnitNames</h5>
<div id="validDisplayUnitNames" class="listingblock">
<div class="content">
<pre>validDisplayUnitNames: Unit +&gt; bool
validDisplayUnitNames(unit) ==
	unit.displayUnit &lt;&gt; nil =&gt;
		-- @OnFail("%NAME: DisplayUnit names must be unique within %s at %#s",
		-- unit.name, loc2str(unit.location))
		( let names = [ u.name | u in seq unit.displayUnit ] in
			len names = card elems names );</pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>See <a href="#figure-schema-DisplayUnit">[figure-schema-DisplayUnit]</a>.</p>
</li>
<li>
<p>See <a href="#uniqueNameAttribute">[uniqueNameAttribute]</a>.</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="_a_4_4_3_rule_validinverseandoffset">A.4.4.3 Rule: validInverseAndOffset</h5>
<div id="validInverseAndOffset" class="listingblock">
<div class="content">
<pre>validInverseAndOffset: DisplayUnit +&gt; bool
validInverseAndOffset(dunit) ==
	-- @OnFail("%NAME: inverse is only allowed if offset = 0 at %#s", loc2str(dunit.location))
	( dunit.$inverse = true =&gt; dunit.offset = 0 )</pre>
</div>
</div>
<div class="paragraph">
<p>See <a href="#figure-schema-DisplayUnit">[figure-schema-DisplayUnit]</a>.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_a_4_5_typedefinitions_rules">A.4.5 TypeDefinitions Rules</h4>
<div class="sect4">
<h5 id="_a_4_5_1_rule_validtypedefinitionnames">A.4.5.1 Rule: validTypeDefinitionNames</h5>
<div id="validTypeDefinitionNames" class="listingblock">
<div class="content">
<pre>validTypeDefinitionNames: [TypeDefinitions] +&gt; bool
validTypeDefinitionNames(tdefs) ==
	tdefs &lt;&gt; nil =&gt;
		-- @OnFail("%NAME: TypeDefinition names must be unique")
		( let names = [ td.name | td in seq tdefs ] in
			len names = card elems names );</pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>See <a href="#definition-of-types">[definition-of-types]</a>.</p>
</li>
<li>
<p>See <a href="#table-type-details">[table-type-details]</a>.</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="_a_4_5_2_rule_validtypeminmax">A.4.5.2 Rule: validTypeMinMax</h5>
<div id="validTypeMinMax" class="listingblock">
<div class="content">
<pre>validTypeMinMax: fmi3TypeDefinition +&gt; bool
validTypeMinMax(tdef) ==
	let mk_(kmin, kmax) = minMaxOfKind(kindOf(tdef)) in allOf
	([
		-- @OnFail("%NAME: max %s is not a valid value of this type", tdef.max)
		( tdef.max &lt;&gt; nil =&gt; tdef.max &lt;= kmax and tdef.max &gt;= kmin ),

		-- @OnFail("%NAME: min %s is not a valid value of this type", tdef.min)
		( tdef.min &lt;&gt; nil =&gt; tdef.min &lt;= kmax and tdef.min &gt;= kmin ),

		-- @OnFail("%NAME: max %s not &gt;= min %s", tdef.max, tdef.min)
		( tdef.min &lt;&gt; nil and tdef.max &lt;&gt; nil =&gt; tdef.max &gt;= tdef.min )
	])
	pre is_(kindOf(tdef), NumericKind);</pre>
</div>
</div>
<div class="paragraph">
<p>See <a href="#table-type-details">[table-type-details]</a>.</p>
</div>
</div>
<div class="sect4">
<h5 id="_a_4_5_3_rule_validtypedisplayunit">A.4.5.3 Rule: validTypeDisplayUnit</h5>
<div id="validTypeDisplayUnit" class="listingblock">
<div class="content">
<pre>validTypeDisplayUnit: fmi3TypeDefinition +&gt; bool
validTypeDisplayUnit(tdef) ==
	-- @OnFail("%NAME: Type %s, unit must be defined for displayUnit %s",
	-- tdef.name, tdef.displayUnit)
	( tdef.displayUnit &lt;&gt; nil =&gt; tdef.unit &lt;&gt; nil )
pre is_(kindOf(tdef), FloatKind);</pre>
</div>
</div>
<div class="paragraph">
<p>See <a href="#table-type-details">[table-type-details]</a>.</p>
</div>
</div>
<div class="sect4">
<h5 id="_a_4_5_4_rule_validenumerationtypebijection">A.4.5.4 Rule: validEnumerationTypeBijection</h5>
<div id="validEnumerationTypeBijection" class="listingblock">
<div class="content">
<pre>validEnumerationTypeBijection: EnumerationType +&gt; bool
validEnumerationTypeBijection(tdef) ==
	-- @OnFail("%NAME: Type %s, Enumeration item name/values do not form a bijection", tdef.name)
	(
		card { i.name | i in seq tdef.item } = len tdef.item
		and	card { i.value | i in seq tdef.item } = len tdef.item
	);</pre>
</div>
</div>
<div class="paragraph">
<p>See <a href="#figure-schema-EnumerationType">[figure-schema-EnumerationType]</a>.</p>
</div>
</div>
<div class="sect4">
<h5 id="_a_4_5_5_rule_validclocktype">A.4.5.5 Rule: validClockType</h5>
<div id="validClockType" class="listingblock">
<div class="content">
<pre>validClockType: ClockType +&gt; bool
validClockType(tdef) ==
	let periodic = clockIsPeriodic(tdef) in allOf
	([
		--@OnFail("%NAME: resolution can only be used with periodic clocks")
		( tdef.resolution &lt;&gt; nil =&gt; periodic ),

		--@OnFail("%NAME: Periodic supportsFraction and intervalCounter must define resolution")
		( periodic and tdef.supportsFraction = true and tdef.intervalCounter &lt;&gt; nil =&gt;
			tdef.resolution &lt;&gt; nil  ),

		--@OnFail("%NAME: intervalCounter must be &gt;0")
		( tdef.intervalCounter &lt;&gt; nil =&gt; tdef.intervalCounter &gt; 0 ),

		--@OnFail("%NAME: Cannot use intervalCounter unless periodic and supportsFraction")
		( tdef.intervalCounter &lt;&gt; nil =&gt; tdef.supportsFraction = true and periodic ),

		--@OnFail("%NAME: shiftCounter requires an intervalCounter")
		( tdef.shiftCounter &lt;&gt; nil =&gt; tdef.intervalCounter &lt;&gt; nil )
	]);</pre>
</div>
</div>
<div class="paragraph">
<p>See <a href="#figure-schema-ClockType">[figure-schema-ClockType]</a>.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_a_4_6_logcategories_rules">A.4.6 LogCategories Rules</h4>
<div class="sect4">
<h5 id="_a_4_6_1_rule_validlogcategories">A.4.6.1 Rule: validLogCategories</h5>
<div id="validLogCategories" class="listingblock">
<div class="content">
<pre>validLogCategories: LogCategories +&gt; bool
validLogCategories(cats) ==
	-- @OnFail("%NAME: LogCategory names are not unique: %s",
	-- { cats(a).name | a, b in set inds cats &amp;
	--   a &lt;&gt; b and cats(a).name = cats(b).name })
	( card { c.name | c in seq cats } = len cats );</pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>See <a href="#definition-of-log-categories">[definition-of-log-categories]</a>.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_a_4_7_defaultexperiment_rules">A.4.7 DefaultExperiment Rules</h4>
<div class="sect4">
<h5 id="_a_4_7_1_rule_validtolerance">A.4.7.1 Rule: validTolerance</h5>
<div id="validTolerance" class="listingblock">
<div class="content">
<pre>validTolerance: DefaultExperiment +&gt; bool
validTolerance(de) ==
	-- @OnFail("%NAME: tolerance must be &gt;= 0 at %#s", loc2str(de.location))
	( de.tolerance &lt;&gt; nil =&gt; de.tolerance &gt;= 0 );</pre>
</div>
</div>
<div class="paragraph">
<p>See <a href="#DefaultExperiment">[DefaultExperiment]</a>.</p>
</div>
</div>
<div class="sect4">
<h5 id="_a_4_7_2_rule_validstartstoptime">A.4.7.2 Rule: validStartStopTime</h5>
<div id="validStartStopTime" class="listingblock">
<div class="content">
<pre>validStartStopTime: DefaultExperiment +&gt; bool
validStartStopTime(e) ==
	-- @OnFail("%NAME: stop time must be later than start time at %#s", loc2str(e.location))
	( e.startTime &lt;&gt; nil and e.stopTime &lt;&gt; nil =&gt; e.stopTime &gt; e.startTime );</pre>
</div>
</div>
<div class="paragraph">
<p>See <a href="#DefaultExperiment">[DefaultExperiment]</a>.</p>
</div>
</div>
<div class="sect4">
<h5 id="_a_4_7_3_rule_validstepsize">A.4.7.3 Rule: validStepSize</h5>
<div id="validStepSize" class="listingblock">
<div class="content">
<pre>validStepSize: DefaultExperiment +&gt; bool
validStepSize(e) ==
	-- @OnFail("%NAME: stepSize must be less than start-stop interval at %#s", loc2str(e.location))
	( e.startTime &lt;&gt; nil and e.stopTime &lt;&gt; nil and e.stepSize &lt;&gt; nil =&gt;
		e.stopTime - e.startTime &gt; e.stepSize );</pre>
</div>
</div>
<div class="paragraph">
<p>See <a href="#DefaultExperiment">[DefaultExperiment]</a>.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_a_4_8_modelvariables_rules">A.4.8 ModelVariables Rules</h4>
<div class="sect4">
<h5 id="_a_4_8_1_effective_model_variables">A.4.8.1 Effective Model Variables</h5>
<div class="paragraph">
<p>Note that the rules in this section are checking the "raw" ModelVariable values, before any field values are defaulted or inherited from a <em>declaredType</em>. This is in contrast to the ModelVariables passed to the rules in the <a href="#FmiModelDescription">[FmiModelDescription]</a> section.</p>
</div>
</div>
<div class="sect4">
<h5 id="_a_4_8_2_rule_validvaluereferences">A.4.8.2 Rule: validValueReferences</h5>
<div id="validValueReferences" class="listingblock">
<div class="content">
<pre>validValueReferences: ModelVariables +&gt; bool
validValueReferences(mvs) ==
	let refs = [ mv.valueReference | mv in seq mvs ] in
		-- @OnFail("%NAME: ModelVariable valueReferences must be unique: %s",
		--	{ vr | vr in seq refs &amp; len [ v2 | v2 in seq refs &amp; vr = v2 ] &gt; 1 })
		( len refs = card elems refs );</pre>
</div>
</div>
<div class="paragraph">
<p>See <a href="#_platform_dependent_definitions">[_platform_dependent_definitions]</a>.</p>
</div>
</div>
<div class="sect4">
<h5 id="_a_4_8_3_rule_validaliasnames">A.4.8.3 Rule: validAliasNames</h5>
<div id="validAliasNames" class="listingblock">
<div class="content">
<pre>validAliasNames: ModelVariables +&gt; bool
validAliasNames(mvs) ==
	let aliases = conc [ [ a.name | a in seq mv.alias ] | mv in seq mvs &amp; mv.alias &lt;&gt; nil ],
		names = [ mv.name | mv in seq mvs ] ^ aliases
	in
		-- @OnFail("%NAME: ModelVariable names and aliases must be unique")
		( len names = card elems names );</pre>
</div>
</div>
<div class="paragraph">
<p>See <a href="#_alias_variables">[_alias_variables]</a>.</p>
</div>
</div>
<div class="sect4">
<h5 id="_a_4_8_4_rule_validindependentvariable">A.4.8.4 Rule: validIndependentVariable</h5>
<div id="validIndependentVariable" class="listingblock">
<div class="content">
<pre>validIndependentVariable: ModelVariables +&gt; bool
validIndependentVariable(mvs) ==
	-- @OnFail("%NAME: Variables define more than one independent variable: %s",
	-- { mv.name | mv in seq mvs &amp; mv.causality = &lt;independent&gt; })
	( card { mv | mv in seq mvs &amp; mv.causality = &lt;independent&gt; } &lt;= 1 );</pre>
</div>
</div>
<div class="paragraph">
<p>See <a href="#ModelVariables">[ModelVariables]</a>.</p>
</div>
</div>
<div class="sect4">
<h5 id="_a_4_8_5_rule_validpreviousvariables">A.4.8.5 Rule: validPreviousVariables</h5>
<div id="validPreviousVariables" class="listingblock">
<div class="content">
<pre>validPreviousVariables: ModelVariables +&gt; bool
validPreviousVariables(mvs) ==
	let plist =  [ mv.previous | mv in seq mvs &amp; not is_Clock(mv) and mv.previous &lt;&gt; nil ]
	in
		-- @OnFail("%NAME: Variable previous fields are not unique: %s",
		-- { mvs(a).name | a, b in set inds mvs &amp; not is_Clock(a) and not is_Clock(b) and
		--   a &lt;&gt; b and mvs(a).previous &lt;&gt; nil and mvs(a).previous = mvs(b).previous } )
		( card elems plist = len plist );</pre>
</div>
</div>
<div class="paragraph">
<p>See <a href="#ModelVariables">[ModelVariables]</a>.</p>
</div>
</div>
<div class="sect4">
<h5 id="_a_4_8_6_rule_validvariabledimensions">A.4.8.6 Rule: validVariableDimensions</h5>
<div id="validVariableDimensions" class="listingblock">
<div class="content">
<pre>validVariableDimensions: ModelVariables +&gt; bool
validVariableDimensions(mvs) ==
	allOf(conc
	[
		[
			-- @OnFail("%NAME: Dimension of %s cannot reference itself", mv.name)
			( mv.fmi3Dimensions &lt;&gt; nil =&gt;
				forall dim in seq mv.fmi3Dimensions &amp;
					dim.valueReference &lt;&gt; nil =&gt;
						dim.valueReference &lt;&gt; mv.valueReference ),

			-- @OnFail("%NAME: Dimension of %s, %s", mv.name,
			-- "valueReference is not Integer, constant or structuralParameter, with start")
			( mv.fmi3Dimensions &lt;&gt; nil =&gt;
				forall dim in seq mv.fmi3Dimensions &amp;
					dim.valueReference &lt;&gt; nil =&gt;
						exists r in seq mvs &amp;
							r.valueReference = dim.valueReference
							and is_IntegerKind(kindOf(r))
							and ( r.causality = &lt;structuralParameter&gt;
								  or r.variability = &lt;constant&gt; )
							and r.start &lt;&gt; nil and len r.start = 1 and r.start(1) &gt;= 0 ),

			-- @OnFail("%NAME: Structural parameter %s cannot have Dimension", mv.name)
			( mv.fmi3Dimensions &lt;&gt; nil =&gt;
				mv.causality &lt;&gt; &lt;structuralParameter&gt; )
		]

		| mv in seq mvs &amp; not is_Clock(mv)	-- Clocks have no dimensions
	]);</pre>
</div>
</div>
<div class="paragraph">
<p>See <a href="#ModelVariables">[ModelVariables]</a>.</p>
</div>
</div>
<div class="sect4">
<h5 id="_a_4_8_7_rule_validstartandvref">A.4.8.7 Rule: validStartAndVRef</h5>
<div id="validStartAndVRef" class="listingblock">
<div class="content">
<pre>validStartAndVRef: Dimension +&gt; bool
validStartAndVRef(d) ==
	-- @OnFail("%NAME: Dimension cannot define start and valueReference at %#s", loc2str(d.location))
	( d.start = nil &lt;=&gt; d.valueReference &lt;&gt; nil );</pre>
</div>
</div>
<div class="paragraph">
<p>See <a href="#ModelVariables">[ModelVariables]</a>.</p>
</div>
</div>
<div class="sect4">
<h5 id="_a_4_8_8_rule_validaliasdisplayunits">A.4.8.8 Rule: validAliasDisplayUnits</h5>
<div id="validAliasDisplayUnits" class="listingblock">
<div class="content">
<pre>validAliasDisplayUnits: ModelVariables +&gt; bool
validAliasDisplayUnits(mvs) ==
	allOf
	([
		[
			-- @OnFail("%NAME: Alias displayUnit requires Float with unit definition at %#s",
			-- loc2str(a.location))
			( a.displayUnit &lt;&gt; nil =&gt; isFloat(mv) and mv.unit &lt;&gt; nil )

			| a in seq mv.alias
		]

		| mv in seq mvs &amp; mv.alias &lt;&gt; nil
	]);</pre>
</div>
</div>
<div class="paragraph">
<p>See <a href="#ModelVariables">[ModelVariables]</a>.</p>
</div>
</div>
<div class="sect4">
<h5 id="_a_4_8_9_rule_validmodelvariables">A.4.8.9 Rule: validModelVariables</h5>
<div id="validModelVariables" class="listingblock">
<div class="content">
<pre>validModelVariables: ModelVariables +&gt; bool
validModelVariables(svs) == allOf
([
	-- @OnFail("%NAME: Variables define more than one independent variable: %s",
	--	{ sv.name | sv in seq svs &amp; sv.causality = &lt;independent&gt; })
	( card { sv | sv in seq svs &amp; sv.causality = &lt;independent&gt; } &lt;= 1 ),

	-- @OnFail("%NAME: Variable names are not unique: %s",
	--	{ svs(a).name | a, b in set inds svs &amp;
	--		a &lt;&gt; b and svs(a).name = svs(b).name } )
	( card { sv.name | sv in seq svs } = len svs ),

	-- @OnFail("%NAME: Variable previous fields are not unique: %s",
	--	{ svs(a).name | a, b in set inds svs &amp; not is_Clock(a) and not is_Clock(b) and
	--		a &lt;&gt; b and svs(a).previous &lt;&gt; nil and svs(a).previous = svs(b).previous } )
	( let plist =  [ sv.previous | sv in seq svs &amp; not is_Clock(sv) and sv.previous &lt;&gt; nil ] in
		card elems plist = len plist ),

	[
		-- @OnFail("%NAME: Variable %s invalid at %#s", sv.name, loc2str(sv.location))
		( validVariableAttributes(sv) )

		| sv in seq svs
	]
]);</pre>
</div>
</div>
<div class="paragraph">
<p>See <a href="#ModelVariables">[ModelVariables]</a>.</p>
</div>
</div>
<div class="sect4">
<h5 id="_a_4_8_10_rule_validvariableattributes">A.4.8.10 Rule: validVariableAttributes</h5>
<div id="validVariableAttributes" class="listingblock">
<div class="content">
<pre>validVariableAttributes: fmi3Variable +&gt; bool
validVariableAttributes(sv) ==
	let eCausality   = effectiveCausality(sv.causality, kindOf(sv)),
		eVariability = effectiveVariability(sv.variability, kindOf(sv)),
		eInitial     = effectiveInitial(sv.causality, sv.variability,
						if is_Clock(sv) then nil else sv.initial, kindOf(sv))
	in
	allOf([
		-- @OnFail("%NAME: %s causality/variability/initial/start %s/%s/%s/%s invalid at %#s",
		--	sv.name, eCausality, eVariability, eInitial, sv.start, loc2str(sv.location))
		(
			cases eCausality:
				&lt;structuralParameter&gt; -&gt;
					eVariability in set {&lt;fixed&gt;, &lt;tunable&gt;}
					and eInitial = &lt;exact&gt;,	-- (A)

				&lt;parameter&gt; -&gt;
					eVariability in set {&lt;fixed&gt;, &lt;tunable&gt;}
					and eInitial = &lt;exact&gt;,	-- (A)

				&lt;calculatedParameter&gt; -&gt;
					eVariability in set {&lt;fixed&gt;, &lt;tunable&gt;}
					and eInitial in set {&lt;approx&gt;, &lt;calculated&gt;},	-- (B)

				&lt;input&gt; -&gt;
					(eVariability in set {&lt;discrete&gt;, &lt;continuous&gt;}
						-- and eInitial = nil
						and not is_Clock(sv) =&gt; sv.start &lt;&gt; nil),	-- (D)

				&lt;independent&gt; -&gt;
					eVariability = &lt;continuous&gt;
					and eInitial = nil		-- (D)
					and sv.start = nil
					-- @OnFail(1461, "2.4.7 Independent variable must be Float at %#s",
					-- loc2str(sv.location))
					and (is_Float64(sv) or is_Float32(sv)),

				&lt;output&gt; -&gt;
					cases eVariability:
						&lt;constant&gt; -&gt;
							eInitial in set {&lt;exact&gt;},	-- (A)

						&lt;discrete&gt;,
						&lt;continuous&gt; -&gt;
							eInitial in set { &lt;exact&gt;, &lt;approx&gt;, &lt;calculated&gt; }, -- (C)

						others -&gt; false
					end,

				&lt;local&gt; -&gt;
					cases eVariability:
						&lt;constant&gt; -&gt;
							eInitial = &lt;exact&gt;,	-- (A)

						&lt;fixed&gt;,
						&lt;tunable&gt; -&gt;
							eInitial in set { &lt;calculated&gt;, &lt;approx&gt; },	-- (B)

						&lt;discrete&gt;,
						&lt;continuous&gt; -&gt;
							eInitial in set { &lt;exact&gt;, &lt;approx&gt;, &lt;calculated&gt; }, -- (C)

						others -&gt; false
					end
			end
		),

		-- @OnFail("%NAME: %s variability/causality %s/%s invalid at %#s",
		--	sv.name, eVariability, eCausality, loc2str(sv.location))
		(
			cases eVariability:
				&lt;constant&gt; -&gt;
					eCausality in set {&lt;output&gt;, &lt;local&gt;},

				&lt;fixed&gt;, &lt;tunable&gt; -&gt;
					eCausality in set {&lt;structuralParameter&gt;, &lt;parameter&gt;,
									   &lt;calculatedParameter&gt;, &lt;local&gt;},

				&lt;discrete&gt; -&gt;
					eCausality in set {&lt;input&gt;, &lt;output&gt;, &lt;local&gt;},

				&lt;continuous&gt; -&gt;
					eCausality in set {&lt;input&gt;, &lt;output&gt;, &lt;local&gt;, &lt;independent&gt;}
					-- @OnFail(1463, "2.4.7 Continuous variable must be Real at %#s",
					-- loc2str(sv.location))
					and (is_Float64(sv) or is_Float32(sv))
			end
		),

		-- @OnFail("%NAME: %s initial/causality %s/%s invalid at %#s",
		--	sv.name, sv.initial, eCausality, loc2str(sv.location))
		(
			not is_Clock(sv) =&gt;
				sv.initial &lt;&gt; nil =&gt;
					eCausality &lt;&gt; &lt;independent&gt;
		),

		-- @OnFail("%NAME: %s initial/variability/start %s/%s/%s invalid at %#s",
		--	sv.name, eInitial, eVariability, sv.start, loc2str(sv.location))
		(
			cases eInitial:
				&lt;exact&gt; -&gt;
					not is_Clock(sv) =&gt; sv.start &lt;&gt; nil,

				&lt;approx&gt; -&gt;
					(not is_Clock(sv) =&gt; sv.start &lt;&gt; nil)
					and eVariability &lt;&gt; &lt;constant&gt;,

				&lt;calculated&gt; -&gt;
					(not is_Clock(sv) =&gt; sv.start = nil)
					and eVariability &lt;&gt; &lt;constant&gt;,

				nil -&gt;		-- Note that eInitial can be nil
					true	-- Tests on eInitial above are sufficient
			end
		)
	]);</pre>
</div>
</div>
<div class="paragraph">
<p>See <a href="#ModelVariables">[ModelVariables]</a>.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_a_4_9_modelstructure_rules">A.4.9 ModelStructure Rules</h4>
<div class="sect4">
<h5 id="_a_4_9_1_rule_validdependencykinds">A.4.9.1 Rule: validDependencyKinds</h5>
<div class="paragraph">
<p>This rule is used to check Output, ContinuousStateDerivative, ClockedState, InitialUnknown and EventIndicator records, which all share the same structure.</p>
</div>
<div id="validDependencyKinds" class="listingblock">
<div class="content">
<pre>validDependencyKinds: Output | ContinuousStateDerivative | ClockedState |
                      InitialUnknown | EventIndicator +&gt; bool
validDependencyKinds(entry) ==
	entry.dependenciesKind &lt;&gt; nil =&gt;
		-- @OnFail("%NAME: dependencies do not match dependenciesKind at %#s",
		-- loc2str(entry.location))
		( entry.dependencies &lt;&gt; nil and len entry.dependenciesKind = len entry.dependencies );</pre>
</div>
</div>
<div class="paragraph">
<p>See <a href="#modelStructure">[modelStructure]</a>.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_a_4_10_fmimodeldescription_rules">A.4.10 FmiModelDescription Rules</h4>
<div class="sect4">
<h5 id="_a_4_10_1_effective_model_variables">A.4.10.1 Effective Model Variables</h5>
<div class="paragraph">
<p>Note that  ModelVariables are passed to some of the rules in this section, in addition to the FmiModelDescription. The ModelVariables passed are <em>effective ModuleVariables</em>, whose fields have been set to default values or inherited from the <em>declaredType</em> of the variable. The calculation of effective ModelVariables is defined by a function called <em>effectiveVariables</em>.</p>
</div>
</div>
<div class="sect4">
<h5 id="_a_4_10_2_rule_validmodeltypes">A.4.10.2 Rule: validModelTypes</h5>
<div id="validModelTypes" class="listingblock">
<div class="content">
<pre>validModelTypes: FmiModelDescription +&gt; bool
validModelTypes(fmd) ==
	-- @OnFail("%NAME: ModelExchange, CoSimulation or ScheduledExecution must be set")
	( fmd.modelExchange &lt;&gt; nil or fmd.coSimulation &lt;&gt; nil or fmd.scheduledExecution &lt;&gt; nil );</pre>
</div>
</div>
<div class="paragraph">
<p>See <a href="#table-schema-fmiModelDescription">[table-schema-fmiModelDescription]</a>.</p>
</div>
</div>
<div class="sect4">
<h5 id="_a_4_10_3_rule_validgenerationdateandtime">A.4.10.3 Rule: validGenerationDateAndTime</h5>
<div id="validGenerationDateAndTime" class="listingblock">
<div class="content">
<pre>validGenerationDateAndTime: FmiModelDescription +&gt; bool
validGenerationDateAndTime(fmd) ==
	-- @OnFail("%NAME: generationDateAndTime should be YYYY-MM-DDThh:mm:ssZ at %#s",
	-- loc2str(fmd.location))
	( fmd.generationDateAndTime &lt;&gt; nil =&gt; iso8601(fmd.generationDateAndTime) );</pre>
</div>
</div>
<div class="paragraph">
<p>See <a href="#table-schema-fmiModelDescription-attributes">[table-schema-fmiModelDescription-attributes]</a>.</p>
</div>
</div>
<div class="sect4">
<h5 id="_a_4_10_4_rule_validtypeunits">A.4.10.4 Rule: validTypeUnits</h5>
<div id="validTypeUnits" class="listingblock">
<div class="content">
<pre>validTypeUnits: FmiModelDescription +&gt; bool
validTypeUnits(fmd) ==
	fmd.typeDefinitions &lt;&gt; nil =&gt; allOf
	([
		tdef.unit &lt;&gt; nil =&gt;
			-- @OnFail("%NAME: Type %s, unit %s not defined in UnitDefinitions at %#s",
			-- tdef.name, tdef.unit, loc2str(tdef.location))
			( fmd.unitDefinitions &lt;&gt; nil
				and exists u in seq fmd.unitDefinitions &amp; u.name = tdef.unit )

		| tdef in seq fmd.typeDefinitions &amp; isFloat(tdef)
	]);</pre>
</div>
</div>
<div class="paragraph">
<p>See <a href="#table-type-details">[table-type-details]</a>.</p>
</div>
</div>
<div class="sect4">
<h5 id="_a_4_10_5_rule_validvariabletypes">A.4.10.5 Rule: validVariableTypes</h5>
<div id="validVariableTypes" class="listingblock">
<div class="content">
<pre>validVariableTypes: FmiModelDescription +&gt; bool
validVariableTypes(fmd) == allOf
	([
		mv.declaredType &lt;&gt; nil =&gt;
		let tdef = lookupType(mv.declaredType, fmd.typeDefinitions) in
			-- @OnFail("%NAME: %s type %s not found at %#s",
			-- mv.name, mv.declaredType, loc2str(mv.location))
			( tdef &lt;&gt; nil )

			-- @OnFail("%NAME: %s type %s mismatch at %#s",
			-- mv.name, mv.declaredType, loc2str(mv.location))
			and ( kindOf(tdef) = kindOf(mv) )

		| mv in seq fmd.modelVariables
	]);</pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>See <a href="#ModelVariables">[ModelVariables]</a>.</p>
</li>
<li>
<p>See <a href="#definition-of-types">[definition-of-types]</a>.</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="_a_4_10_6_rule_validtypenames">A.4.10.6 Rule: validTypeNames</h5>
<div id="validTypeNames" class="listingblock">
<div class="content">
<pre>validTypeNames: FmiModelDescription +&gt; bool
validTypeNames(fmd) == fmd.typeDefinitions &lt;&gt; nil =&gt; allOf
	([
		-- @OnFail("%NAME: TypeDefinition and Variable names overlap: %s at %#s",
		-- tdef.name, loc2str(tdef.location))
		( not exists mv in seq fmd.modelVariables &amp; mv.name = tdef.name )

		| tdef in seq fmd.typeDefinitions
	]);</pre>
</div>
</div>
<div class="paragraph">
<p>See <a href="#table-type-details">[table-type-details]</a>.</p>
</div>
</div>
<div class="sect4">
<h5 id="_a_4_10_7_rule_validvariablenames">A.4.10.7 Rule: validVariableNames</h5>
<div id="validVariableNames" class="listingblock">
<div class="content">
<pre>validVariableNames: FmiModelDescription +&gt; bool
validVariableNames(fmd) ==
	fmd.variableNamingConvention = &lt;structured&gt; =&gt; allOf(conc
	[
		[
			-- @OnFail("%NAME: Structured name %s invalid at %#s", mv.name, loc2str(mv.location))
			( validStructuredName(mv.name) ),

			-- @OnFail("%NAME: Name %s is not Float at %#s", mv.name, loc2str(mv.location))
			( mv.name(1, ..., 4) = "der(" =&gt; isFloat(mv) )
		]

		| mv in seq fmd.modelVariables
	]);</pre>
</div>
</div>
<div class="paragraph">
<p>See <a href="#ModelVariables">[ModelVariables]</a>.</p>
</div>
</div>
<div class="sect4">
<h5 id="_a_4_10_8_rule_validstart">A.4.10.8 Rule: validStart</h5>
<div id="validStart" class="listingblock">
<div class="content">
<pre>validStart: FmiModelDescription * ModelVariables +&gt; bool
validStart(-, evs) == allOf
	([
		[
			ev.start &lt;&gt; nil =&gt;
				-- @OnFail("%NAME: all start values must be between %s and %s at %#s",
				-- ev.min, ev.max, ev.location)
				( forall sv in seq ev.start &amp; ev.min &lt;= sv and ev.max &gt;= sv ),

			ev.start = nil and ev.initial &lt;&gt; &lt;calculated&gt; =&gt;
				-- @OnFail("%NAME: Warning: implicit start of 0 not within min/max at %#s",
				-- ev.location)
				( (ev.min &lt;&gt; nil =&gt; ev.min &lt;= 0) and
				  (ev.max &lt;&gt; nil =&gt; ev.max &gt;= 0) ) or true	-- NOTE warning
		]

		| ev in seq evs &amp; is_NumericKind(kindOf(ev))
	]);</pre>
</div>
</div>
<div class="paragraph">
<p>See <a href="#table-type-attributes">[table-type-attributes]</a>.</p>
</div>
</div>
<div class="sect4">
<h5 id="_a_4_10_9_rule_validminmax">A.4.10.9 Rule: validMinMax</h5>
<div id="validMinMax" class="listingblock">
<div class="content">
<pre>validMinMax: FmiModelDescription * ModelVariables +&gt; bool
validMinMax(-, evs) == allOf
	([
		let mk_(kmin, kmax) = minMaxOfKind(kindOf(ev)) in
		[
			-- @OnFail("%NAME: max %s is not a valid value of this type", ev.max)
			( ev.max &lt;= kmax and ev.max &gt;= kmin ),

			-- @OnFail("%NAME: min %s is not a valid value of this type", ev.min)
			( ev.min &lt;= kmax and ev.min &gt;= kmin ),

			-- @OnFail("%NAME: max %s not &gt;= min %s", ev.max, ev.min)
			( ev.max &gt;= ev.min )
		]

		| ev in seq evs &amp; is_NumericKind(kindOf(ev))
	]);</pre>
</div>
</div>
<div class="paragraph">
<p>See <a href="#table-type-attributes">[table-type-attributes]</a>.</p>
</div>
</div>
<div class="sect4">
<h5 id="_a_4_10_10_rule_validmultiplesets">A.4.10.10 Rule: validMultipleSets</h5>
<div id="validMultipleSets" class="listingblock">
<div class="content">
<pre>validMultipleSets: FmiModelDescription * ModelVariables +&gt; bool
validMultipleSets(fmd, evs) == allOf
	([
		ev.canHandleMultipleSetPerTimeInstant = true =&gt;
			-- @OnFail("%NAME: Variable %s, canHandleMultipleSetPerTimeInstant invalid at %#s",
			-- ev.name, loc2str(ev.location))
			( fmd.modelExchange &lt;&gt; nil and ev.causality = &lt;input&gt; )

		| ev in seq evs
	]);</pre>
</div>
</div>
<div class="paragraph">
<p>See <a href="#table-variableBase-attributes">[table-variableBase-attributes]</a>.</p>
</div>
</div>
<div class="sect4">
<h5 id="_a_4_10_11_rule_validreinits">A.4.10.11 Rule: validReinits</h5>
<div id="validReinits" class="listingblock">
<div class="content">
<pre>validReinits: FmiModelDescription +&gt; bool
validReinits(fmd) == allOf
	([
		isFloat(mv) and mv.reinit &lt;&gt; nil =&gt;
			-- @OnFail("%NAME: %s, Float reinit for model exchange continuous time only at %#s",
			-- mv.name, loc2str(mv.location))
			( isContinuousTimeState(mv, fmd.modelVariables) and fmd.modelExchange &lt;&gt; nil )

		| mv in seq fmd.modelVariables
	]);</pre>
</div>
</div>
<div class="paragraph">
<p>See <a href="#ModelVariables">[ModelVariables]</a>.</p>
</div>
</div>
<div class="sect4">
<h5 id="_a_4_10_12_rule_validcseventmode">A.4.10.12 Rule: validCSEventMode</h5>
<div id="validCSEventMode" class="listingblock">
<div class="content">
<pre>validCSEventMode: FmiModelDescription +&gt; bool
validCSEventMode(fmd) ==
	fmd.coSimulation &lt;&gt; nil =&gt;
		-- @OnFail("%NAME: hasEventMode must be true since FMU has clocks at %#s",
		-- loc2str(fmd.coSimulation.location))
		( let hasClocks = exists mv in seq fmd.modelVariables &amp; is_Clock(mv) in
			hasClocks =&gt; fmd.coSimulation.hasEventMode = true );</pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>See <a href="#table-CoSimulation-details">[table-CoSimulation-details]</a>.</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="_a_4_10_13_rule_validoutput">A.4.10.13 Rule: validOutput</h5>
<div id="validOutput" class="listingblock">
<div class="content">
<pre>validOutput: FmiModelDescription * ModelVariables +&gt; bool
validOutput(fmd, evs) ==
	let outputRefs = { ev.valueReference | ev in seq evs &amp; ev.causality = &lt;output&gt; },
		structRefs = { u.valueReference | u in seq
						default[seq of Output](fmd.modelStructure.output, []) }
	in
		if outputRefs &lt;&gt; {}
		then
			-- @OnFail("%NAME: Output variables but no outputs declared at %#s",
			-- loc2str(fmd.modelStructure.location))
			( structRefs &lt;&gt; {} )

			and
			-- @OnFail("%NAME: Outputs section does not match output variables at %#s",
			-- loc2str(fmd.modelStructure.location))
			( structRefs = outputRefs )
		else
			-- @OnFail("%NAME: Outputs should be omitted at %#s",
			-- loc2str(fmd.modelStructure.location))
			( structRefs = {} );</pre>
</div>
</div>
<div class="paragraph">
<p>See <a href="#ModelStructure">[ModelStructure]</a>.</p>
</div>
</div>
<div class="sect4">
<h5 id="_a_4_10_14_rule_validstatederivatives">A.4.10.14 Rule: validStateDerivatives</h5>
<div id="validStateDerivatives" class="listingblock">
<div class="content">
<pre>validStateDerivatives: FmiModelDescription * ModelVariables +&gt; bool
validStateDerivatives(fmd, evs) ==
	fmd.modelExchange &lt;&gt; nil =&gt; allOf
	([
		let ev = lookupVariable(uk.valueReference, evs) in
			-- @OnFail("%NAME: Derivative valueReference unknown at %#s", loc2str(uk.location))
			( ev &lt;&gt; nil )

			and allOf
			([
				-- @OnFail("%NAME: SV not a state derivative at %#s", loc2str(uk.location))
				( isStateDerivative(ev) ),

				-- @OnFail("%NAME: Derivative must be continuous at %#s", loc2str(uk.location))
				( uk.dependencies &lt;&gt; nil =&gt; ev.variability = &lt;continuous&gt; )
			])

		| uk in seq default[seq of ContinuousStateDerivative]
						(fmd.modelStructure.continuousStateDerivative, [])
	]);</pre>
</div>
</div>
<div class="paragraph">
<p>See <a href="#ModelStructure">[ModelStructure]</a>.</p>
</div>
</div>
<div class="sect4">
<h5 id="_a_4_10_15_rule_validinitialunknowns">A.4.10.15 Rule: validInitialUnknowns</h5>
<div id="validInitialUnknowns" class="listingblock">
<div class="content">
<pre>validInitialUnknowns: FmiModelDescription * ModelVariables +&gt; bool
validInitialUnknowns(fmd, evs) ==
	let ctVars = continuousTimeStates(evs),
		sdVars = stateDerivatives(evs),
		required = { ev.valueReference | ev in seq evs &amp;
			(ev.clocks = nil and ev.causality = &lt;output&gt;
				and not is_Clock(ev) and ev.initial in set { &lt;approx&gt;, &lt;calculated&gt; })

			or (ev.causality = &lt;calculatedParameter&gt;)

			or (ev in set ctVars
				and ev.initial in set { &lt;approx&gt;, &lt;calculated&gt; })

			or (ev in set sdVars
				and ev.initial in set { &lt;approx&gt;, &lt;calculated&gt; }) },

		optional = { ev.valueReference | ev in seq evs &amp; ev.clocks &lt;&gt; nil },
		IUs      = default[seq of InitialUnknown](fmd.modelStructure.initialUnknown, []),
		allIUs   = { iu.valueReference | iu in seq IUs },
		allEIs   = { ei.valueReference | ei in seq
					default[seq of EventIndicator](fmd.modelStructure.eventIndicator, []) }
	in
		allOf
		([
			-- ?? @OnFail("%NAME: InitialUnknowns must include refs: %s",
			-- required \ allIUs) ?? This may not be true!
			-- ( required subset allIUs ),

			-- @OnFail("%NAME: InitialUnknowns can only include refs: %s",
			-- required union optional)
			( allIUs subset required union optional ),

			-- @OnFail("%NAME: InitialUnknowns cannot include EventIndicators: %s ",
			-- allIUs inter allEIs)
			( allIUs inter allEIs = {} ),

			-- @OnFail("%NAME: InitialUnknowns must not have duplicates: %s")
			( card allIUs = len IUs ),

			[
				iu.dependencies &lt;&gt; nil and iu.dependencies &lt;&gt; [] =&gt;
					-- @OnFail("%NAME: InitialUnknown dependencies must all be known at %#s",
					-- loc2str(iu.location))
					( forall d in seq iu.dependencies &amp; d not in set allIUs )

				| iu in seq IUs
			]
		]);</pre>
</div>
</div>
<div class="paragraph">
<p>See <a href="#ModelStructure">[ModelStructure]</a>.</p>
</div>
</div>
<div class="sect4">
<h5 id="_a_4_10_16_rule_valideventindicators">A.4.10.16 Rule: validEventIndicators</h5>
<div id="validEventIndicators" class="listingblock">
<div class="content">
<pre>validEventIndicators: FmiModelDescription * ModelVariables +&gt; bool
validEventIndicators(fmd, evs) ==
	fmd.modelStructure.eventIndicator &lt;&gt; nil =&gt; allOf
	([
		-- @OnFail("%NAME: EventIndicator valueReference %s invalid at %#s",
		-- ei.valueReference, loc2str(ei.location))
		( exists ev in seq evs &amp; ev.valueReference = ei.valueReference )

		| ei in seq fmd.modelStructure.eventIndicator
	]);</pre>
</div>
</div>
<div class="paragraph">
<p>See <a href="#ModelStructure">[ModelStructure]</a>.</p>
</div>
</div>
<div class="sect4">
<h5 id="_a_4_10_17_rule_validoutputreferences">A.4.10.17 Rule: validOutputReferences</h5>
<div id="validOutputReferences" class="listingblock">
<div class="content">
<pre>validOutputReferences: FmiModelDescription * ModelVariables +&gt; bool
validOutputReferences(fmd, evs) ==
	fmd.modelStructure.output &lt;&gt; nil =&gt; allOf
	([
		-- @OnFail("%NAME: Output valueReference %s is not an output at %#s",
		--  ei.valueReference, loc2str(ei.location))
		( exists ev in seq evs &amp;
			ev.valueReference = ei.valueReference and ev.causality = &lt;output&gt; )

		| ei in seq fmd.modelStructure.output
	]);</pre>
</div>
</div>
<div class="paragraph">
<p>See <a href="#ModelStructure">[ModelStructure]</a>.</p>
</div>
</div>
<div class="sect4">
<h5 id="_a_4_10_18_rule_validunknowndependencies">A.4.10.18 Rule: validUnknownDependencies</h5>
<div id="validUnknownDependencies" class="listingblock">
<div class="content">
<pre>validUnknownDependencies: FmiModelDescription * ModelVariables +&gt; bool
validUnknownDependencies(fmd, evs) ==
	let allUnknowns = conc
	[
		default[seq of Output](fmd.modelStructure.output, []),
		default[seq of ContinuousStateDerivative](fmd.modelStructure.continuousStateDerivative, []),
		default[seq of ClockedState](fmd.modelStructure.clockedState, []),
		default[seq of InitialUnknown](fmd.modelStructure.initialUnknown, []),
		default[seq of EventIndicator](fmd.modelStructure.eventIndicator, [])
	] in
		allUnknowns &lt;&gt; [] =&gt; allOf
		([
			unk.dependencies &lt;&gt; nil and unk.dependencies &lt;&gt; [] =&gt; allOf
			([
				-- @OnFail("%NAME: Unknown dependency %s invalid at %#s",
				-- vr, loc2str(unk.location))
				( exists ev in seq evs &amp; ev.valueReference = vr )

				| vr in seq unk.dependencies
			])

			| unk in seq allUnknowns
		]);</pre>
</div>
</div>
<div class="paragraph">
<p>See <a href="#ModelStructure">[ModelStructure]</a>.</p>
</div>
</div>
<div class="sect4">
<h5 id="_a_4_10_19_rule_validclockpriorities">A.4.10.19 Rule: validClockPriorities</h5>
<div id="validClockPriorities" class="listingblock">
<div class="content">
<pre>validClockPriorities: FmiModelDescription * ModelVariables +&gt; bool
validClockPriorities(fmd, evs) == allOf
	([
		if fmd.scheduledExecution &lt;&gt; nil then
			cases ev.causality:
				&lt;input&gt; -&gt;
					-- @OnFail("%NAME: Input clock %s must have a priority for SE at %#s",
					-- ev.name, loc2str(ev.location))
					( ev.priority &lt;&gt; nil ),

				&lt;output&gt; -&gt;
					-- @OnFail("%NAME: Output clock %s must not have a priority for SE at %#s",
					-- ev.name, loc2str(ev.location))
					( ev.priority = nil ),

				&lt;local&gt; -&gt; true
			end
		else
			-- @OnFail("%NAME: Clock %s must not have a priority unless SE at %#s",
			-- ev.name, loc2str(ev.location))
			( ev.priority = nil )

		| ev in seq evs &amp; is_Clock(ev)
	]);</pre>
</div>
</div>
<div class="paragraph">
<p>See <a href="#table-type-details">[table-type-details]</a>.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_a_4_11_sourcefileset_rules">A.4.11 SourceFileSet Rules</h4>
<div class="sect4">
<h5 id="_a_4_11_1_rule_validcompileroptions">A.4.11.1 Rule: validCompilerOptions</h5>
<div id="validCompilerOptions" class="listingblock">
<div class="content">
<pre>validCompilerOptions: SourceFileSet +&gt; bool
validCompilerOptions(sfs) ==
	-- @OnFail("%NAME: Compiler options set without compiler at %#s", loc2str(sfs.location))
	( sfs.compilerOptions &lt;&gt; nil =&gt; sfs.compiler &lt;&gt; nil );</pre>
</div>
</div>
<div class="paragraph">
<p>See <a href="#table-SourceFileSet-details">[table-SourceFileSet-details]</a>.</p>
</div>
</div>
<div class="sect4">
<h5 id="_a_4_11_2_rule_validsourcefilenames">A.4.11.2 Rule: validSourceFileNames</h5>
<div id="validSourceFileNames" class="listingblock">
<div class="content">
<pre>validSourceFileNames: SourceFileSet +&gt; bool
validSourceFileNames(sfs) ==
	let files = sfs.sourceFile in
	let names = [ sf.name | sf in seq files ] in
		-- @OnFail("%NAME: SourceFileSet has duplicate names: %s",
		--	{ files(a) | a, b in set inds names &amp; a &lt;&gt; b and files(a) = files(b) })
		( card elems names = len names );</pre>
</div>
</div>
<div class="paragraph">
<p>See <a href="#table-SourceFile-details">[table-SourceFile-details]</a>.</p>
</div>
</div>
<div class="sect4">
<h5 id="_a_4_11_3_rule_validpreprocessordefinitionnames">A.4.11.3 Rule: validPreprocessorDefinitionNames</h5>
<div id="validPreprocessorDefinitionNames" class="listingblock">
<div class="content">
<pre>validPreprocessorDefinitionNames: SourceFileSet +&gt; bool
validPreprocessorDefinitionNames(sfs) ==
	let defs = sfs.preprocessorDefinition in
	defs &lt;&gt; nil =&gt;
		let names = [ d.name | d in seq defs ] in
			-- @OnFail("%NAME: PreprocessorDefinitions has duplicate names: %s",
			--	{ names(a) | a, b in set inds names &amp; a &lt;&gt; b and names(a) = names(b) })
			( card elems names = len names );</pre>
</div>
</div>
<div class="paragraph">
<p>See <a href="#table-ProcessorDefinition-details">[table-ProcessorDefinition-details]</a>.</p>
</div>
</div>
<div class="sect4">
<h5 id="_a_4_11_4_rule_validincludedirectorynames">A.4.11.4 Rule: validIncludeDirectoryNames</h5>
<div id="validIncludeDirectoryNames" class="listingblock">
<div class="content">
<pre>validIncludeDirectoryNames: SourceFileSet +&gt; bool
validIncludeDirectoryNames(sfs) ==
	let incs = sfs.includeDirectory in
	incs &lt;&gt; nil =&gt;
		let names = [ d.name | d in seq incs ] in
			-- @OnFail("%NAME: IncludeDirectories has duplicate names: %s",
			--	{ names(a) | a, b in set inds names &amp; a &lt;&gt; b and names(a) = names(b) })
			( card elems names = len names );</pre>
</div>
</div>
<div class="paragraph">
<p>See <a href="#table-IncludeDirectory-details">[table-IncludeDirectory-details]</a>.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_a_4_12_terminals_rules">A.4.12 Terminals Rules</h4>
<div class="sect4">
<h5 id="_a_4_12_1_rule_validcoordinatesystem">A.4.12.1 Rule: validCoordinateSystem</h5>
<div id="validCoordinateSystem" class="listingblock">
<div class="content">
<pre>validCoordinateSystem: CoordinateSystem +&gt; bool
validCoordinateSystem(cs) == allOf
	([
		-- @OnFail("%NAME: Coordinate system has zero area at %#s", loc2str(cs.location))
		( cs.x1 &lt;&gt; cs.x2 and cs.y1 &lt;&gt; cs.y2 ),

		-- @OnFail("%NAME: Coordinate system is not bottom left to top right at %#s",
		-- loc2str(cs.location))
		( isBLtoTR(cs.x1, cs.y1, cs.x2, cs.y2) )
	]);</pre>
</div>
</div>
<div class="paragraph">
<p>See <a href="#_coordinatesystem">[_coordinatesystem]</a>.</p>
</div>
</div>
<div class="sect4">
<h5 id="_a_4_12_2_rule_validicon">A.4.12.2 Rule: validIcon</h5>
<div id="validIcon" class="listingblock">
<div class="content">
<pre>validIcon: Icon +&gt; bool
validIcon(icon) ==
	-- @OnFail("%NAME: Icon has zero area at %#s", loc2str(icon.location))
	( icon.x1 &lt;&gt; icon.x2 and icon.y1 &lt;&gt; icon.y2 );</pre>
</div>
</div>
<div class="paragraph">
<p>See <a href="#_icon">[_icon]</a>.</p>
</div>
</div>
<div class="sect4">
<h5 id="_a_4_12_3_rule_validterminalmembervariables">A.4.12.3 Rule: validTerminalMemberVariables</h5>
<div id="validTerminalMemberVariables" class="listingblock">
<div class="content">
<pre>validTerminalMemberVariables: Terminal * [FmiModelDescription] +&gt; bool
validTerminalMemberVariables(terminal, fmd) ==
	let tmvs = terminal.terminalMemberVariable in
	tmvs &lt;&gt; nil and fmd &lt;&gt; nil =&gt; allOf
	([
		let var = lookupVariableName(tmv.variableName, fmd.modelVariables) in
			-- @OnFail("%NAME: Terminal member variable %s not declared at %#s",
			-- tmv.variableName, loc2str(tmv.location))
			( var &lt;&gt; nil )

		| tmv in seq tmvs
	]);</pre>
</div>
</div>
<div class="paragraph">
<p>See <a href="#section-terminalvars">[section-terminalvars]</a>.</p>
</div>
</div>
<div class="sect4">
<h5 id="_a_4_12_4_rule_validterminalstreammembervariables">A.4.12.4 Rule: validTerminalStreamMemberVariables</h5>
<div id="validTerminalStreamMemberVariables" class="listingblock">
<div class="content">
<pre>validTerminalStreamMemberVariables: Terminal * [FmiModelDescription] +&gt; bool
validTerminalStreamMemberVariables(terminal, fmd) ==
	let tsmvs = terminal.terminalStreamMemberVariable in
	tsmvs &lt;&gt; nil and fmd &lt;&gt; nil =&gt;allOf
	([
		let ivar = lookupVariableName(tsmv.inStreamVariableName, fmd.modelVariables),
			ovar = lookupVariableName(tsmv.outStreamVariableName, fmd.modelVariables)
		in
		[
			-- @OnFail("%NAME: Terminal inStreamVariableName %s not declared at %#s",
			-- tsmv.inStreamVariableName, loc2str(tsmv.location))
			( ivar &lt;&gt; nil ),

			-- @OnFail("%NAME: Terminal outStreamVariableName %s not declared at %#s",
			-- tsmv.outStreamVariableName, loc2str(tsmv.location))
			( ovar &lt;&gt; nil )
		]

		| tsmv in seq tsmvs
	]);</pre>
</div>
</div>
<div class="paragraph">
<p>See <a href="#_terminal_stream_member_variable">[_terminal_stream_member_variable]</a>.</p>
</div>
</div>
<div class="sect4">
<h5 id="_a_4_12_5_rule_validterminalgraphicalrepresentation">A.4.12.5 Rule: validTerminalGraphicalRepresentation</h5>
<div id="validTerminalGraphicalRepresentation" class="listingblock">
<div class="content">
<pre>validTerminalGraphicalRepresentation: Terminal +&gt; bool
validTerminalGraphicalRepresentation(terminal) ==
	let tgr = terminal.terminalGraphicalRepresentation in
	tgr &lt;&gt; nil =&gt; allOf
	([
		-- @OnFail("%NAME: Terminal area is zero at %#s", loc2str(tgr.location))
		( tgr.x1 &lt;&gt; tgr.x2 and tgr.y1 &lt;&gt; tgr.y2 ),

		-- @OnFail("%NAME: Colour attributes must be octets (&lt;=255) at %#s",
		-- loc2str(tgr.location))
		( tgr.defaultConnectionColor &lt;&gt; nil =&gt;
			forall c in seq tgr.defaultConnectionColor &amp; c &lt;= 255 ),

		-- @OnFail("%NAME: defaultConnectionStrokeSize must be &gt;0 at %#s",
		-- loc2str(tgr.location))
		( tgr.defaultConnectionStrokeSize &lt;&gt; nil =&gt;
			tgr.defaultConnectionStrokeSize &gt; 0 )
	]);</pre>
</div>
</div>
<div class="paragraph">
<p>See <a href="#_terminal_graphical_representation">[_terminal_graphical_representation]</a>.</p>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Last updated 2024-01-26 11:42:54 UTC
</div>
</div>
</body>
</html>